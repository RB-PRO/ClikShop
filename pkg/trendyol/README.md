# trendyol

[Это ](www.trendyol.com)очень странный сайт по своему устройству. Даже не имею предсположений, на чём он сделан и чем оперируется.

### Путь парсера

Сперва мы должны обладать априорной информацией о том, какие бренды нам нужны и получить соответствующие ID "mid".

##### Список товаров

Для примера возьмём Superstep(Далее - ss):

`https://www.trendyol.com/sr?mid=106871&os=1`

Ссылка строгая для всех брендов и каждый бренд обладает своим ID. В ss это `106871`.

По открытии этой ссылки мы видим все товары данного производителя, но мы хотим, чтобы наш скрейпер не мешал работе сайта и не гонял лишние байты по сети, поэтому находим ручку со списком товаров в формате json:

`https://public.trendyol.com/discovery-web-searchgw-service/v2/api/infinite-scroll/sr?mid=106871&os=1&pi=2`

Эта ссылка откроет вторую страницу бренда ss.

* `mid` - ID бренда
* `ip` - номер страницы, начиная с 1.

В каждой странице по 24 товара. `result.totalCount` - количество товаров. В этом огромном списке нам нужны поля `result.products[i].productGroupId`, где содержимое - integer. Запомним пример productGroupId - productGroupId576856731

##### Гуппа товаров

Оно же - productGroupId. Товары устроены таким образом, то все вариации товара объеденены в группы с ID - productGroupId. Давайте расспитрим пример топков tnf:

`https://www.trendyol.com/the-north-face/back-to-berkeley-su-gecirmez-erkek-siyah-bot-p-758370082`

Эта ссылка содержит ссылку на товар босоножек, а ручка к этому запросу:

`https://public.trendyol.com/discovery-web-websfxproductgroups-santral/api/v1/product-groups/576856731`

* Последнее значение - ID группы товаров, productGroupId, у нас взяли из примера выше

Тут нам опять интересно запомнить только ID категорий, потму что ничего более приличного в этом контенте нет. Путь до id: `result.slicingAttributes[0].attributes[i].contents[0].id`

##### Вариации

Ссылка на пример товара идентична ссылке выше. А вот ручка для неё ниже:

`https://public.trendyol.com/discovery-web-productgw-service/api/productDetail/758370082?storefrontId=1`

* id - `758370082`, Это ID вариаций, которые мы получили на предыдущем шаге

Тут у нас лежит весь целевой контент на все вариации товара c фотками, ссылками и прочим контентом

#### Дополнительные сведения

##### Поставщик

Оказывается на сайте в самом товаре есть непосредственный продавец вариации товара. Это надо учитывать. Путь к продавцу вариации товара: `merchantListings.merchant.name`

Это надо учитывать. Напрмиер мы берём только те товары, поставщико которых нам интересен. Кстати вы скажите: "Анон, а зачем нам логика сложная, если в товаре пишется его название, а это может повлиять на количестве ошибок при загрузке товара при проверка текущей категории с продавцом?". А я Вам отвечу, то оно вам нахуй не нужно, потому что помимо имени вариация содержит ID производителя/продавца. Например в Superstep id категории `106871`, ровно такой же, как и прописано в вариации товара.
